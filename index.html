<!DOCTYPE html>
<!-- This is a sample integration of the Braze Web SDK.
     Visit https://js.appboycdn.com/web-sdk/latest/sample-build/index.html to see a deployed instance of this page
-->
<html>
  <head>
    <title>Braze Web SDK Sample Integration</title>
    <script type="text/javascript">
      +function(a,p,P,b,y){a.appboy={};a.appboyQueue=[];for(var s="initialize destroy getDeviceId toggleAppboyLogging setLogger openSession changeUser requestImmediateDataFlush requestFeedRefresh subscribeToFeedUpdates requestContentCardsRefresh subscribeToContentCardsUpdates logCardImpressions logCardClick logCardDismissal logFeedDisplayed logContentCardsDisplayed logInAppMessageImpression logInAppMessageClick logInAppMessageButtonClick logInAppMessageHtmlClick subscribeToNewInAppMessages subscribeToInAppMessage removeSubscription removeAllSubscriptions logCustomEvent logPurchase isPushSupported isPushBlocked isPushGranted isPushPermissionGranted registerAppboyPushMessages unregisterAppboyPushMessages trackLocation stopWebTracking resumeWebTracking wipeData ab ab.DeviceProperties ab.User ab.User.Genders ab.User.NotificationSubscriptionTypes ab.User.prototype.getUserId ab.User.prototype.setFirstName ab.User.prototype.setLastName ab.User.prototype.setEmail ab.User.prototype.setGender ab.User.prototype.setDateOfBirth ab.User.prototype.setCountry ab.User.prototype.setHomeCity ab.User.prototype.setLanguage ab.User.prototype.setEmailNotificationSubscriptionType ab.User.prototype.setPushNotificationSubscriptionType ab.User.prototype.setPhoneNumber ab.User.prototype.setAvatarImageUrl ab.User.prototype.setLastKnownLocation ab.User.prototype.setUserAttribute ab.User.prototype.setCustomUserAttribute ab.User.prototype.addToCustomAttributeArray ab.User.prototype.removeFromCustomAttributeArray ab.User.prototype.incrementCustomUserAttribute ab.User.prototype.addAlias ab.User.prototype.setCustomLocationAttribute ab.InAppMessage ab.InAppMessage.SlideFrom ab.InAppMessage.ClickAction ab.InAppMessage.DismissType ab.InAppMessage.OpenTarget ab.InAppMessage.ImageStyle ab.InAppMessage.TextAlignment ab.InAppMessage.Orientation ab.InAppMessage.CropType ab.InAppMessage.prototype.subscribeToClickedEvent ab.InAppMessage.prototype.subscribeToDismissedEvent ab.InAppMessage.prototype.removeSubscription ab.InAppMessage.prototype.removeAllSubscriptions ab.InAppMessage.prototype.closeMessage ab.InAppMessage.Button ab.InAppMessage.Button.prototype.subscribeToClickedEvent ab.InAppMessage.Button.prototype.removeSubscription ab.InAppMessage.Button.prototype.removeAllSubscriptions ab.SlideUpMessage ab.ModalMessage ab.FullScreenMessage ab.HtmlMessage ab.ControlMessage ab.Feed ab.Feed.prototype.getUnreadCardCount ab.ContentCards ab.ContentCards.prototype.getUnviewedCardCount ab.Card ab.Card.prototype.dismissCard ab.ClassicCard ab.CaptionedImage ab.Banner ab.ControlCard ab.WindowUtils display display.automaticallyShowNewInAppMessages display.showInAppMessage display.showFeed display.destroyFeed display.toggleFeed display.showContentCards display.hideContentCards display.toggleContentCards sharedLib".split(" "),i=0;i<s.length;i++){for(var m=s[i],k=a.appboy,l=m.split("."),j=0;j<l.length-1;j++)k=k[l[j]];k[l[j]]=(new Function("return function "+m.replace(/\./g,"_")+"(){window.appboyQueue.push(arguments); return true}"))()}window.appboy.getUser=function(){return new window.appboy.ab.User};window.appboy.getCachedFeed=function(){return new window.appboy.ab.Feed};window.appboy.getCachedContentCards=function(){return new window.appboy.ab.ContentCards};(y=p.createElement(P)).type='text/javascript';
        y.src='https://js.appboycdn.com/web-sdk/2.4/appboy.min.js';
        y.async=1;(b=p.getElementsByTagName(P)[0]).parentNode.insertBefore(y,b)
      }(window,document,'script');
      // See https://js.appboycdn.com/web-sdk/2.4/doc/module-appboy.html#.initialize for options
      appboy.initialize('aaf29661-76ce-4cc7-9646-687dd76d4786', {
        enableLogging: true,
        baseUrl: 'https://sdk.iad-03.braze.com/api/v3',
        // Warning: Using the serviceWorkerLocation option limits the scope of push notifications on your site. See
        // https://js.appboycdn.com/web-sdk/2.4/doc/module-appboy.html#.initialize for more details.
        // If in doubt, omit this option and use the default location of /service-worker.js
        //serviceWorkerLocation: document.location.pathname.replace('index.html', 'service-worker.js'),
        safariWebsitePushId: 'web.nz.co.nzherald.play'
      });
      //appboy.display.automaticallyShowNewInAppMessages();
      appboy.openSession();
      //appboy.display.showFeed();
      //appboy.getUser().setCustomUserAttribute('visited sample-build', new Date());
         
         
     function printDebugInfo() {

       var browserId = "";
       appboy.getDeviceId(function(deviceId) {
           console.log('the device id is ' + deviceId);
           browserId = deviceId;
         });
       var pushSupported = appboy.isPushSupported();
       var pushPermissionGranted = appboy.isPushPermissionGranted();
       var pushBlocked = appboy.isPushBlocked();

       var node = document.createElement("LI");
       var browserIdNode = document.createTextNode("Browser Id: "+ browserId);
       node.appendChild(browserIdNode);
       document.getElementById("debugInfo").appendChild(node);

       node = document.createElement("LI");
       var pushSupportedNode = document.createTextNode("Push Supported: "+ pushSupported);
       node.appendChild(pushSupportedNode);
       document.getElementById("debugInfo").appendChild(node);

       node = document.createElement("LI");
       var permissionGrantedNode = document.createTextNode("Push permission granted: "+ pushPermissionGranted);
       node.appendChild(permissionGrantedNode);
       document.getElementById("debugInfo").appendChild(node);

       node = document.createElement("LI");
       var pushBlockedNode = document.createTextNode("Push blocked: "+ pushBlocked);
       node.appendChild(pushBlockedNode);
       document.getElementById("debugInfo").appendChild(node);      

     }         
     
    </script>

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

  </head>
  <body onload="printDebugInfo()">
    This is a sample integration of the Braze Web SDK, with web push integrated.
    <br/><br/>
    <!-- This App Group has a triggered push campaign tied to the "send me push" custom event -->
    <button onclick="appboy.registerAppboyPushMessages();">Enable Push Notification</button>
    <button onclick="appboy.registerAppboyPushMessages(function() {appboy.logCustomEvent('send me push');appboy.requestImmediateDataFlush();});">Send Me A Sample Push</button>
       
    <br/><br/>
    <ul id="debugInfo">
       <li><b>Debug Info</b></li>
     </ul>
  </body>
</html>
